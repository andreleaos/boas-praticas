Testes desse projeto

âœ… 1. Testes UnitÃ¡rios

ğŸ“œ Objetivo:
- Validar o comportamento de unidades isoladas, especialmente os Use Cases.

ğŸ—ï¸ Exemplo â€” Teste UnitÃ¡rio do Use Case CadastrarClienteUseCase

package br.com.exemplo.application.usecase;

import br.com.exemplo.domain.entity.Cliente;
import br.com.exemplo.domain.repository.ClienteRepository;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.Mockito;

import static org.mockito.Mockito.*;
import static org.junit.jupiter.api.Assertions.*;

public class CadastrarClienteUseCaseTest {

    private ClienteRepository repository;
    private CadastrarClienteUseCase useCase;

    @BeforeEach
    void setup() {
        repository = mock(ClienteRepository.class);
        useCase = new CadastrarClienteUseCase(repository);
    }

    @Test
    void deveCadastrarClienteComSucesso() {
        Cliente cliente = new Cliente(null, "AndrÃ© LeÃ£o", "andre@email.com", "119999999");

        when(repository.salvar(cliente)).thenReturn(new Cliente(1L, "AndrÃ© LeÃ£o", "andre@email.com", "119999999"));

        Cliente resultado = useCase.executar(cliente);

        assertNotNull(resultado.getId());
        assertEquals("AndrÃ© LeÃ£o", resultado.getNome());
        verify(repository, times(1)).salvar(cliente);
    }
}

--

ğŸš¦ Rodar Testes UnitÃ¡rios

mvn test

---

âœ… 2. Testes de IntegraÃ§Ã£o

ğŸ“œ Objetivo:

- Validar a integraÃ§Ã£o dos componentes principais.
- Verificar se a API funciona de ponta a ponta, incluindo banco de dados (pode ser um banco em memÃ³ria, como H2).

ğŸ—ï¸ Exemplo â€” Teste de IntegraÃ§Ã£o da API ClienteController

package br.com.exemplo.adapter.controller;

import br.com.exemplo.domain.entity.Cliente;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.http.*;

import java.util.List;

import static org.junit.jupiter.api.Assertions.*;

@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
public class ClienteControllerIntegrationTest {

    @Autowired
    private TestRestTemplate restTemplate;

    @Test
    void deveCadastrarEBuscarCliente() {
        Cliente cliente = new Cliente(null, "Carlos Silva", "carlos@email.com", "119888888");

        ResponseEntity<Cliente> response = restTemplate.postForEntity(
                "/api/clientes",
                cliente,
                Cliente.class
        );

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertNotNull(response.getBody());
        assertNotNull(response.getBody().getId());

        Cliente clienteSalvo = response.getBody();

        ResponseEntity<Cliente> buscaResponse = restTemplate.getForEntity(
                "/api/clientes/" + clienteSalvo.getId(),
                Cliente.class
        );

        assertEquals(HttpStatus.OK, buscaResponse.getStatusCode());
        assertEquals("Carlos Silva", buscaResponse.getBody().getNome());
    }

    @Test
    void deveListarClientes() {
        ResponseEntity<Cliente[]> response = restTemplate.getForEntity(
                "/api/clientes",
                Cliente[].class
        );

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertTrue(response.getBody().length >= 0);
    }
}

--

ğŸš¦ Rodar Testes de IntegraÃ§Ã£o

Mesmo comando dos testes unitÃ¡rios:

mvn test

âœ”ï¸ A anotaÃ§Ã£o @SpringBootTest sobe o contexto da aplicaÃ§Ã£o inteiro.

âœ… 3. DocumentaÃ§Ã£o da API com Swagger / OpenAPI

ğŸ§° DependÃªncia Maven (Swagger â€” Springdoc OpenAPI)

Adicione no pom.xml:

<dependency>
    <groupId>org.springdoc</groupId>
    <artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
    <version>2.5.0</version>
</dependency>


ğŸ”¥ ConfiguraÃ§Ã£o automÃ¡tica (a partir do Springdoc)

âœ”ï¸ NÃ£o precisa criar classes de configuraÃ§Ã£o manual.
âœ”ï¸ O Swagger UI estarÃ¡ automaticamente disponÃ­vel em:

http://localhost:8080/swagger-ui/index.html

âœ”ï¸ A especificaÃ§Ã£o OpenAPI estarÃ¡ em:

http://localhost:8080/v3/api-docs

âœ¨ Exemplo de customizaÃ§Ã£o opcional

package br.com.exemplo.framework;

import io.swagger.v3.oas.models.info.Info;
import io.swagger.v3.oas.models.OpenAPI;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class SwaggerConfig {

    @Bean
    public OpenAPI customOpenAPI() {
        return new OpenAPI()
                .info(new Info()
                        .title("API de Clientes - Clean Architecture")
                        .version("1.0.0")
                        .description("DocumentaÃ§Ã£o da API de Clientes seguindo Clean Architecture."));
    }
}

---

âœ… Swagger UI gerado automaticamente

âœ”ï¸ Todos os endpoints da API /api/clientes serÃ£o documentados:

- POST /api/clientes â†’ Cadastrar cliente
- GET /api/clientes/{id} â†’ Buscar cliente por ID
- GET /api/clientes â†’ Listar todos
- PUT /api/clientes/{id} â†’ Atualizar cliente
- DELETE /api/clientes/{id} â†’ Deletar cliente

ğŸš€ Checklist Completo

| Item                    | Status |
| ----------------------  | ------ |
| âœ… Testes UnitÃ¡rios     | âœ”ï¸     |
| âœ… Testes de IntegraÃ§Ã£o | âœ”ï¸     |
| âœ… DocumentaÃ§Ã£o Swagger | âœ”ï¸     |
