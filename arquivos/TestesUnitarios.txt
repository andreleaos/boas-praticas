Testes Unitarios

Perfeito, bora avanÃ§ar para o mundo dos Testes UnitÃ¡rios em Java, que Ã© absolutamente essencial
para garantir a qualidade, robustez e evoluÃ§Ã£o segura do cÃ³digo.

ğŸ§  Testes UnitÃ¡rios â€” Conceitos e PrÃ¡tica em Java

ğŸ”¥ O que sÃ£o Testes UnitÃ¡rios?

- SÃ£o testes que verificam o comportamento de uma unidade de cÃ³digo isolada, geralmente mÃ©todos ou classes.
- Garantem que cada parte do cÃ³digo funciona como esperado de forma isolada.
- Detectam erros logo no desenvolvimento, antes de subir para ambientes maiores.

ğŸ—ï¸ Estrutura dos Testes UnitÃ¡rios

- ğŸ“¦ Ferramenta mais utilizada: JUnit (JUnit 5 Ã© o mais atual)
- ğŸ§° Para mocks e stubs: Mockito

ğŸ”§ DependÃªncias no Maven

<dependencies>
    <!-- JUnit 5 -->
    <dependency>
        <groupId>org.junit.jupiter</groupId>
        <artifactId>junit-jupiter</artifactId>
        <version>5.9.3</version>
        <scope>test</scope>
    </dependency>

    <!-- Mockito -->
    <dependency>
        <groupId>org.mockito</groupId>
        <artifactId>mockito-core</artifactId>
        <version>5.7.0</version>
        <scope>test</scope>
    </dependency>
</dependencies>

---

ğŸš¦ AnotaÃ§Ãµes principais no JUnit 5

| AnotaÃ§Ã£o       | DescriÃ§Ã£o                                 |
| -------------- | ----------------------------------------- |
| `@Test`        | Define um mÃ©todo como teste unitÃ¡rio.     |
| `@BeforeEach`  | Executa antes de cada teste.              |
| `@AfterEach`   | Executa apÃ³s cada teste.                  |
| `@BeforeAll`   | Executa uma vez antes de todos os testes. |
| `@AfterAll`    | Executa uma vez apÃ³s todos os testes.     |
| `@DisplayName` | DÃ¡ um nome legÃ­vel para o teste.          |
| `@Disabled`    | Desabilita um teste temporariamente.      |

ğŸ”¥ Exemplo PrÃ¡tico de Teste UnitÃ¡rio Simples

public class Calculadora {
    public int somar(int a, int b) {
        return a + b;
    }

    public int dividir(int a, int b) {
        if (b == 0) {
            throw new IllegalArgumentException("DivisÃ£o por zero nÃ£o permitida.");
        }
        return a / b;
    }
}

âœ”ï¸ Teste UnitÃ¡rio com JUnit 5:

import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

public class CalculadoraTest {

    Calculadora calculadora = new Calculadora();

    @Test
    @DisplayName("Deve somar dois nÃºmeros corretamente")
    void deveSomarDoisNumeros() {
        int resultado = calculadora.somar(5, 7);
        assertEquals(12, resultado);
    }

    @Test
    @DisplayName("Deve lanÃ§ar exceÃ§Ã£o ao dividir por zero")
    void deveLancarExcecaoDivisaoPorZero() {
        Exception exception = assertThrows(IllegalArgumentException.class, () -> {
            calculadora.dividir(10, 0);
        });

        assertEquals("DivisÃ£o por zero nÃ£o permitida.", exception.getMessage());
    }
}

âœ”ï¸ Passa se:

- O mÃ©todo de soma retorna corretamente.
- A divisÃ£o por zero lanÃ§a exceÃ§Ã£o corretamente.

---

ğŸ”¥ Testes com DependÃªncias â€” Usando Mockito

âœ”ï¸ CenÃ¡rio: Uma classe que depende de um repositÃ³rio (DAO).

public class ClienteService {

    private ClienteRepository repository;

    public ClienteService(ClienteRepository repository) {
        this.repository = repository;
    }

    public String buscarNomeDoClientePorId(Long id) {
        Cliente cliente = repository.buscarPorId(id);
        if (cliente == null) {
            throw new IllegalArgumentException("Cliente nÃ£o encontrado.");
        }
        return cliente.getNome();
    }
}


âœ”ï¸ Interface simulada:

public interface ClienteRepository {
    Cliente buscarPorId(Long id);
}


âœ”ï¸ Classe de modelo:

public class Cliente {
    private Long id;
    private String nome;

    public Cliente(Long id, String nome) {
        this.id = id;
        this.nome = nome;
    }

    public String getNome() {
        return nome;
    }
}


âœ”ï¸ Teste com Mockito:

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.Mockito;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.Mockito.*;

public class ClienteServiceTest {

    private ClienteRepository repository;
    private ClienteService service;

    @BeforeEach
    void setup() {
        repository = mock(ClienteRepository.class);
        service = new ClienteService(repository);
    }

    @Test
    @DisplayName("Deve retornar o nome do cliente quando encontrado")
    void deveRetornarNomeCliente() {
        when(repository.buscarPorId(1L)).thenReturn(new Cliente(1L, "AndrÃ©"));

        String nome = service.buscarNomeDoClientePorId(1L);

        assertEquals("AndrÃ©", nome);
        verify(repository, times(1)).buscarPorId(1L);
    }

    @Test
    @DisplayName("Deve lanÃ§ar exceÃ§Ã£o quando cliente nÃ£o for encontrado")
    void deveLancarExcecaoQuandoClienteNaoEncontrado() {
        when(repository.buscarPorId(2L)).thenReturn(null);

        Exception ex = assertThrows(IllegalArgumentException.class, () -> {
            service.buscarNomeDoClientePorId(2L);
        });

        assertEquals("Cliente nÃ£o encontrado.", ex.getMessage());
    }
}

ğŸ”¥ PirÃ¢mide de Testes â€” Boas PrÃ¡ticas

| NÃ­vel             | DescriÃ§Ã£o                            | Exemplo                                 |
| ----------------- | ------------------------------------ | --------------------------------------- |
| ğŸ§  **UnitÃ¡rio**   | Testa mÃ©todos isolados               | `CalculadoraTest`, `ClienteServiceTest` |
| ğŸ”— **IntegraÃ§Ã£o** | Testa a integraÃ§Ã£o entre componentes | API + Banco + ServiÃ§o + DAO             |
| ğŸ§ª **E2E/UI**     | Testa o sistema de ponta a ponta     | Testes via Selenium, RestAssured, etc.  |

ğŸ† Boas PrÃ¡ticas nos Testes UnitÃ¡rios

- âœ… Nome dos testes devem indicar claramente o que estÃ¡ sendo testado.
- âœ… Um teste = um cenÃ¡rio.
- âœ… Configure o ambiente no @BeforeEach.
- âœ… Isolamento: Nunca dependa de banco real ou serviÃ§os externos.
- âœ… Cobertura de cÃ³digo Ã© importante, mas qualidade dos testes importa mais do que quantidade.
- âœ… Mocks para dependÃªncias externas (banco, APIs, arquivos).

ğŸš€ Ferramentas de Suporte

ğŸ”¹ JUnit 5 â†’ Framework de testes.
ğŸ”¹ Mockito â†’ CriaÃ§Ã£o de mocks e spies.
ğŸ”¹ AssertJ â†’ Assertions mais legÃ­veis e poderosas.
ğŸ”¹ RestAssured â†’ Testes de APIs REST.
ğŸ”¹ Testcontainers â†’ Banco real em container para testes de integraÃ§Ã£o.

